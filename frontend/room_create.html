<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒ«ãƒ¼ãƒ ä½œæˆ</title>
  <link rel="stylesheet" href="/static/css/room.css">
</head>
<body>

<div class="container">
  <h1 class="title">ğŸ  ãƒ«ãƒ¼ãƒ ä½œæˆ</h1>

  <form id="roomForm">
    <input type="text" name="room_name" placeholder="ãƒ«ãƒ¼ãƒ å" required>
    <input type="password" name="password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆä»»æ„ï¼‰">

    <select name="max_players">
      <option value="2">2äºº</option>
      <option value="3">3äºº</option>
      <option value="4">4äºº</option>
    </select>

    <button type="submit">ä½œæˆ</button>
  </form>

  <button class="back-btn" onclick="goBack()">â† æˆ»ã‚‹</button>

  <p id="result"></p>
</div>

<script>
  const user_id = localStorage.getItem("user_id");

  if (!user_id) {
    alert("ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„");
    location.href = "/";
  }

  function goBack() {
    history.back();
  }

  document.getElementById("roomForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const formData = new FormData(e.target);
    formData.append("owner_id", user_id);

    const res = await fetch("/room/create", {
      method: "POST",
      body: formData
    });

    const data = await res.json();

    if (res.ok) {
      location.href = `/room/wait?room_id=${data.room_id}`;
    } else {
      document.getElementById("result").innerText = data.detail;
    }
  });
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>„Éû„É´„ÉÅ„Éó„É¨„Ç§</title>
    <link rel="stylesheet" href="/static/css/play.css">
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <style>
        /* Multi-play specific overrides if needed */
        .room-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
    </style>
</head>

<body>

    <!-- Top Center Toolbar -->
    <div class="header-controls">
        <button class="toolbar-btn" onclick="exitRoom()" title="ÈÄÄÂá∫„Åô„Çã">
            <ion-icon name="log-out-outline" style="transform: rotate(180deg);"></ion-icon>
        </button>

        <div style="width: 1px; height: 24px; background: rgba(255,255,255,0.1); margin: 0 5px;"></div>

        <button class="toolbar-btn" onclick="zoomOut()" title="„Ç∫„Éº„É†„Ç¢„Ç¶„Éà">
            <ion-icon name="remove-circle-outline"></ion-icon>
        </button>
        <button class="toolbar-btn" onclick="zoomIn()" title="„Ç∫„Éº„É†„Ç§„É≥">
            <ion-icon name="add-circle-outline"></ion-icon>
        </button>

        <div style="width: 1px; height: 24px; background: rgba(255,255,255,0.1); margin: 0 5px;"></div>

        <button class="toolbar-btn" id="hintBtn" title="„Éí„É≥„Éà (1„Éî„Éº„ÇπÂüã„ÇÅ„Çã)">
            <ion-icon name="bulb-outline"></ion-icon>
        </button>
        <button class="toolbar-btn" id="toggleCompletedBtn" title="ÂÆåÊàêÂõ≥„ÅÆË°®Á§∫/ÈùûË°®Á§∫">
            <ion-icon name="image-outline"></ion-icon>
        </button>

        <!-- Invite/People Icon (Optional future feature placeholder or member toggle) -->
        <button class="toolbar-btn" style="cursor: default;" title="„Éû„É´„ÉÅ„Éó„É¨„Ç§‰∏≠">
            <ion-icon name="people-outline"></ion-icon>
        </button>
    </div>

    <!-- Top Right Info Panel -->
    <div class="info-panel">
        <div class="timer-box">
            <span id="time">0</span>
        </div>
        <div id="member-list" class="member-list">
            <ion-icon name="person" style="vertical-align: middle; margin-right: 5px;"></ion-icon>
            <span id="members-count">1</span>
        </div>
    </div>

    <!-- Waiting Overlay -->
    <div id="waiting-overlay" style="display:none;"></div>

    <div id="canvas-container">
        <canvas id="can"></canvas>
    </div>

    <!-- Chat Area -->
    <div id="chat-container" class="chat-container">
        <div class="chat-header" onclick="toggleChat()">
            <span>üí¨ Chat</span>
            <span id="chat-toggle">‚ñº</span>
        </div>
        <div id="chat-body" class="chat-body">
            <div id="chat-messages"></div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" placeholder="Message..." maxlength="200">
                <button onclick="sendChatMessage()"
                    style="background:transparent; border:none; cursor:pointer; color:#22c55e;">
                    <ion-icon name="send" style="font-size: 1.2rem;"></ion-icon>
                </button>
            </div>
        </div>
    </div>

    <!-- Clear Modal -->
    <div id="completionModal"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:9999; text-align:center; color:white; flex-direction: column; justify-content: center; align-items: center;">

        <h1 style="font-size:4rem; color:#fbbf24; text-shadow: 0 0 20px rgba(251, 191, 36, 0.5); margin: 0;">Completed!!
        </h1>

        <div style="font-size:1.5rem; margin: 30px 0;">
            <p>Time: <span id="modalTime" style="font-weight:bold; font-size:2.5rem; color: white;"></span></p>
        </div>

        <button onclick="location.href='/room/list-page'"
            style="padding:15px 40px; font-size:1.1rem; background:transparent; border: 2px solid #22c55e; color:#22c55e; border-radius:30px; cursor:pointer; font-weight: bold; transition: all 0.2s;">
            „É´„Éº„É†‰∏ÄË¶ß„Å∏
        </button>
    </div>

    <img id="completedImagePreview" style="display:none;">

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="/static/js/puzzle_logic.js"></script>
    <script src="/static/js/multi_play.js"></script>

</body>

</html>